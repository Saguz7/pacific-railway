version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm i --force
    build:
      commands:
        - env | grep -e "API_URL_BASE\|REGION_POOL\|USER_POOL_ID\|APP_POOL_ID\|DOMAIN_SIGN\|REDIRECT_SIGNIN\|REDIRECT_SIGNOUT\|IDENTITY_PROVIDER" >> .env.production
        - npm run build --prod
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
